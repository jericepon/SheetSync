<!DOCTYPE html>
<html>
  <head>
    <title>SheetSync</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style type="text/tailwindcss">
      :root {
        font-family: "Dank Mono", monospace;
        --color-background: #ffffff;
        --color-foreground: #2c2c2c;
        --color-border: #d9d9d9;

        --radius: 8px;

        --card-padding-x: 24px;
        --card-padding-y: 24px;

        --button-padding-x: 12px;
        --button-padding-y: 12px;

        --gap: 8px;
      }

      @media (prefers-color-scheme: dark) {
        :root {
          --color-background: #1e1e1e;
          --color-foreground: #ffffff;
          --color-border: #434343;
        }
      }

      @layer components {
        .btn {
          @apply w-full hover:opacity-90 flex justify-center items-center cursor-pointer text-lg text-[var(--color-background)] border-1 border-[var(--color-border)] rounded-[var(--radius)] bg-[var(--color-foreground)] p-[var(--button-padding-x)] gap-[var(--gap)];
        }
        .icon {
          width: 14px;
          svg {
            @apply w-full h-full;
          }
        }
        .container {
          @apply flex flex-col items-center justify-center m-auto h-full w-full gap-[26px] p-[var(--card-padding-x)];
        }
      }

      @font-face {
        font-family: "Dank Mono";
        src: url("DankMono-Regular.ttf") format("truetype");
        font-weight: normal;
        font-style: normal;
        font-display: swap;
      }

      @font-face {
        font-family: "Dank Mono";
        src: url("DankMono-Italic.ttf") format("truetype");
        font-weight: normal;
        font-style: italic;
        font-display: swap;
      }

      body,
      html {
        @apply flex flex-col items-center justify-center m-0 max-h-screen;
        background-color: var(--color-background);
        color: var(--color-foreground);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div id="heading" class="text-2xl font-bold text-center w-full">SheetSync</div>
      <input type="file" id="fileInput" accept=".xlsx, .xls" class="text-center w-full" />
      <button id="uploadBtn" class="btn">
        <span>Upload & Populate</span>
        <div class="icon">
          <svg
            width="14"
            height="15"
            viewBox="0 0 14 15"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M13 9.30115V11.9678C13 12.3214 12.8595 12.6606 12.6095 12.9106C12.3594 13.1607 12.0203 13.3011 11.6667 13.3011H2.33333C1.97971 13.3011 1.64057 13.1607 1.39052 12.9106C1.14048 12.6606 1 12.3214 1 11.9678V9.30115M10.3333 4.63448L7 1.30115M7 1.30115L3.66667 4.63448M7 1.30115V9.30115"
              stroke="#2C2C2C"
              stroke-width="1.6"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </div>
      </button>
    </div>

    <script type="module" src="./src/main.ts"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script>
      const input = document.getElementById("fileInput");
      const btn = document.getElementById("uploadBtn");

      btn.onclick = () => {
        const file = input.files[0];
        if (!file) return alert("Please select an Excel file");

        const reader = new FileReader();
        reader.onload = (e) => {
          const data = new Uint8Array(e.target.result);
          const workbook = XLSX.read(data, { type: "array" });
          const firstSheetName = workbook.SheetNames[0];
          const worksheet = workbook.Sheets[firstSheetName];
          const json = XLSX.utils.sheet_to_json(worksheet);

          parent.postMessage({ pluginMessage: { type: "populate-excel", data: json } }, "*");
        };

        reader.readAsArrayBuffer(file);
      };
    </script>
  </body>
</html>
